
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>geoMusings</title>
  <meta name="author" content="Bill Dollins">

  
  <meta name="description" content="See you again in a couple of weeks. Feel free to have a look around. Help yourself to something in the fridge. Please feed the cat and be sure to &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="generator" content="Octopress 2.0" />

  
  <link rel="canonical" href="http://blog.geomusings.com/blog/page/32/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="geoMusings" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">geoMusings</a></h1>
  
    <h2>geospatial technologies and practices</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.geomusings.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/samples">Samples</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/07/11/back-in-a-bit/">Back in a Bit</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-07-11T00:00:00-04:00" pubdate data-updated="true">Jul 11<span>th</span>, 2007</time>
        
         | <a href="/2007/07/11/back-in-a-bit/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img alt="I wish I had a pencil-thin?mustache?" src="http://geobabble.files.wordpress.com/2007/07/fla.jpg" />
See you again in a couple of weeks. Feel free to have a look around. Help yourself to something in the fridge. Please feed the cat and be sure to lock up when you leave.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/07/10/consuming-georss-in-arcmap-with-inmemoryworkspacefactory/">Consuming GeoRSS in ArcMap With InMemoryWorkspaceFactory</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-07-10T00:00:00-04:00" pubdate data-updated="true">Jul 10<span>th</span>, 2007</time>
        
         | <a href="/2007/07/10/consuming-georss-in-arcmap-with-inmemoryworkspacefactory/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This will be my last post for a couple of weeks. I&#8217;m heading out to Florida tomorrow to spend time with my family and the Mouse. But before I head out, I thought I&#8217;d share a little something I&#8217;ve been working on.</p>

<p>I&#8217;ve been playing the last few days with the <a href="http://edndoc.esri.com/arcobjects/9.2/ComponentHelp/esriDataSourcesGDB/InMemoryWorkspaceFactory.htm">InMemoryWorkspaceFactory</a> class in ArcObjects. I am looking at using it for a project I will be working on when I get back so I thought I&#8217;d do a little prototyping beforehand.</p>

<p>The fact that it works in memory is very attractive, especially for using volatile data. <a href="http://georss.org/">GeoRSS</a> seemed like a natural source to use for prototyping.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2007/07/10/consuming-georss-in-arcmap-with-inmemoryworkspacefactory/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/07/09/mo-no-mo/">MO No Mo&#8217;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-07-09T00:00:00-04:00" pubdate data-updated="true">Jul 9<span>th</span>, 2007</time>
        
         | <a href="/2007/07/09/mo-no-mo/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Okay, there&#8217;s nothing terribly surprising about ESRI&#8217;s announcement regarding <a href="http://www.esri.com/software/mapobjects/index.html">MapObjects</a> in this <a href="http://support.esri.com/index.cfm?fa=knowledgebase.techarticles.articleShow&amp;d=31074">technical article</a>. I would have been more surprised if they had announced that it <em>would</em> be supported or that there would be another version or something like that. In truth, I haven&#8217;t touched MapObjects in years. It was dead to me even if it was still on life support at ESRI. But there was something about seeing it in print:</p>

<blockquote>MapObjects Windows 2.4 and MapObjects-Java 2.2 and 2.3 are not supported on the Windows Vista. ESRI is not certifying any new environments for MapObjects-Windows and there are no plans to support Vista with MapObjects-Java.</blockquote>


<p>It brought back a lot of memories. I began programming when I was 10. I wrote a <a href="http://en.wikipedia.org/wiki/Dungeons_and_dragons">D&amp;D</a> character generator in <a href="http://en.wikipedia.org/wiki/BASIC_programming_language">BASIC</a> on a <a href="http://en.wikipedia.org/wiki/Commodore_64">Commodore 64</a>. I guess that makes me an old geek. D&amp;D and computers might even be a double-down. ;-)? I&#8217;ve pretty much been doing some form of BASIC ever since (not so much VB.Net anymore, though, as I do most of my .Net in C#) along with a lot of other languages. I got interested in maps a few years later and discovered I could fuse maps and computers as I headed into the workforce.</p>

<p>Early on, I was able to do some <a href="http://extranet.mapinfo.com/products/Overview.cfm?productid=1063">MapBasic</a> stuff but that didn&#8217;t get too far. So I suffered through AML and Avenue for a while in order to feed the GIS development jones. Then along came MO.</p>

<p>With MO, I was able to introduce an old friend (BASIC in the form of VB5 and later VB6) to a new friend (GIS, although it wasn&#8217;t new to me by then). I was able to write real apps that fused mapping with databases and other cool tools. For one customer, I built a COM system that featured a core UI and provided a pluggable architecture and an API so others could write plug-ins. Then we converted a lot of stand-alone apps to work in the system. Sounds familiar huh?</p>

<p>From a GIS standpoint, MO wasn&#8217;t the most powerful game in town but it was <em>fun</em>! And, if you needed an algorithm or something that MO didn&#8217;t support, you could just implement it yourself in the language of your choice. There are operations that I originally implemented in MO/VB6 that I have migrated and still use in C#/ArcObjects/Others. In case I didn&#8217;t get the point across earlier, it was just plain fun.</p>

<p>That was a while ago. GIS is still fun but I just don&#8217;t use MO anymore (maybe that&#8217;s the problem). ESRI&#8217;s announcement is sort of like when you read that <a href="http://en.wikipedia.org/wiki/Capital_Centre">the arena where you went to all of your concerts in your youth got dynamited to make room for a shopping plaza</a>. So, much like I did that day, I&#8217;ll pop a cold one, raise a glass and say &#8220;Thanks for the memories.&#8221;</p>

<p><img alt="The better part of my hearing was left here." src="http://geobabble.files.wordpress.com/2007/07/cap_centre.png" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/07/04/happy-birthday-america/">Happy Birthday America!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-07-04T00:00:00-04:00" pubdate data-updated="true">Jul 4<span>th</span>, 2007</time>
        
         | <a href="/2007/07/04/happy-birthday-america/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img alt="flag_clay.png" src="http://geobabble.files.wordpress.com/2007/07/flag_clay.png" /></p>

<p>?I hope everyone has a safe and happy 4th.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/06/26/bringing-it-all-together/">Bringing It All Together&#8230;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-06-26T00:00:00-04:00" pubdate data-updated="true">Jun 26<span>th</span>, 2007</time>
        
         | <a href="/2007/06/26/bringing-it-all-together/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>These are pretty fun times to be working in GIS. There&#8217;s an explosion of new technologies across the whole spectrum and integration possibilities are seemingly boundless. Back when I got started, <a href="http://www.esri.com">ESRI</a> and <a href="http://www.intergraph.com">Intergaph</a> were duking it out and others, like <a href="http://www.mapinfo.com">MapInfo</a>, were out there on the periphery also. <a href="http://grass.itc.it/">GRASS</a> was flying the OS banner and there were a few good free tools, such as the various ones put out by <a href="http://en.wikipedia.org/wiki/Sol_Katz">Sol Katz</a> at the <a href="http://www.blm.gov/wo/st/en.html">BLM</a>.</p>

<p>Everything quieted down for a few years but there&#8217;s been a flowering of new technologies (well-documented elsewhere) over the last couple of years in both the commercial and open-source communities. I am particularly impressed with the pace at which the open-source community has ramped up with tools of strong quality and capability. In addition, the back-and-forth between <a href="http://earth.google.com/">Google</a> and <a href="http://www.microsoft.com/virtualearth/default.mspx">Microsoft</a> has put better tools in the hands of the average consumer. That doesn&#8217;t come without drawbacks, but I see it as a net positive.</p>

<p>What I find interesting about all of this activity is that it demonstrates that the closed/commerical/competitive approach can bear fruit and so can the open-source/free/collaborative approach. Where you fall in the spectrum between the two is totally up to you but no one can offer up any concrete evidence that one is vastly superior to the other at this point. In addition, it&#8217;s becoming increasingly clear that they don&#8217;t have to be mutually exclusive.</p>

<p>When you throw in <a href="http://www.opengeospatial.org">OGC</a> standards and well as <em>de facto</em> standards such as <a href="http://code.google.com/apis/kml/documentation/">KML</a>, it becomes quite possible to stitch together technologies of various parentage effectively. I offer up the following as a concrete example:</p>

<p><a href="http://geobabble.files.wordpress.com/2007/06/os_free_commercial.png" title="Click to enlarge..."><img src="http://geobabble.files.wordpress.com/2007/06/os_free_commercial.thumbnail.png" /></a></p>

<p>This screenshot depicts a map (no, it&#8217;s not pretty but blame that on me) that was assembled using several technologies. The application is obviously <a href="http://www.esri.com/software/arcgis/about/desktop_gis.html">ArcMap</a>. Working from the bottom up, the layers are:</p>

<ul>
    <li>Counties - US Counties residing in <a href="http://www.esri.com/software/arcgis/arcsde/">ArcSDE</a> and <a href="http://www.microsoft.com/sql/default.mspx">SQL Server</a></li>
    <li>State Boundaries - US States loaded directly from a local install of <a href="http://postgis.refractions.net/">PostGIS</a> using the <a href="http://code.google.com/p/ziggis/">zigGIS</a> connector</li>
    <li>Major Water - A shapefile on the local hard drive</li>
    <li>Hospitals - A <a href="http://www.opengeospatial.org/standards/wfs">WFS</a> layer being served from my <a href="http://geoserver.org/">GeoServer</a> <a href="http://geobabble.wordpress.com/2007/06/19/my-little-open-source-stack/">instance</a> and loaded into ArcMap with the help of the free <a href="http://www.thecarbonproject.com/carbonarc.php">CarbonArc Lite</a> extension from the <a href="http://www.thecarbonproject.com">Carbon Project</a>. Behind Geoserver, the data sits in PostGIS.</li>
</ul>


<p>So we have commercially licensed software (ArcMap, ArcSDE, SQL Server), freeware (CarbonArc Lite) and open-source software (zigGIS, PostGIS, GeoServer, <a href="http://www.postgresql.org/">PostgreSQL</a>) working together to make this product. All are good tools that, working together, bolster each others&#8217; shortcomings. This kind of thing demostrates the &#8220;best-of-breed&#8221; (hate that term) concept very well.</p>

<p>A few months back, <a href="http://www.paolocorti.net/public/wordpress/index.php/2007/01/19/full-oss-solution-vs-osscommercial-solution-mix/">Paolo posted</a> about mixing commercial and open-source tools. I think this will eventually be the prevalent means of doing business.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/06/25/rotating-a-point-around-a-base-point/">Rotating a Point Around a Base Point</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-06-25T00:00:00-04:00" pubdate data-updated="true">Jun 25<span>th</span>, 2007</time>
        
         | <a href="/2007/06/25/rotating-a-point-around-a-base-point/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A while back, I was working on a project that required us to rotate a polygon around a base point and do a spatial query to analyze some underlying demographic data. I was working in ArcObjects and could find no intrinsic way to do what I needed to do so I wrote the following routine. As you can imagine, I had to break the polygon up into individual points and rotate each one. Despite the fact that I was using ArcObjects point objects and all of the attendant COM interop calls, it worked pretty well (a polygon consisting of ~5000 point was rotated in less than a second on a less-than-robust workstation).</p>

<p>The math is pretty simple: Assuming that the base point and target point form the two ends of the hypotenuse of a right triangle with one leg of the triangle being a segment of the X axis, you simply:</p>

<ol>
    <li>Calculate the length of the hypotenuse</li>
    <li>Calculate the current angle of the hypotenuse</li>
    <li>Add the rotation angle to the current angle</li>
    <li>Calculate the coordinates of the new end point of the hypotenuse</li>
</ol>


<p>The code below shows how to do it but there are a couple of notes about it:</p>

<ul>
    <li>The coordinates must be in decimal degrees so you&#8217;ll need to unproject any projected coordinates and then re-project the result. This <em>may</em> introduce some distortion. I didn&#8217;t notice any in my application but I&#8217;d suggest some more rigorous testing if you&#8217;ve got tight precision requirements.</li>
    <li>Rotation follows engineering standards (zero East, counter-clockwise)</li>
    <li>This code is only mildly based on ArcObjects. It uses the AO IPoint interface and Point but that&#8217;s it. It is trival to implement it with another point object (such as SharpMap) or just use numeric values.</li>
    <li>The base point is shifted to 0,0 and the same offset is applied to all other points in order to keep the math straightforward.</li>
    <li>It&#8217;s in C#</li>
</ul>


<p>So there it is. It&#8217;s fairly simple but it&#8217;s been useful for me on a couple of occasions since I wrote it.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'> <span class="k">private</span> <span class="n">IPoint</span> <span class="nf">rotatePoint</span><span class="p">(</span><span class="n">IPoint</span> <span class="n">basePoint</span><span class="p">,</span> <span class="n">IPoint</span> <span class="n">sourcePoint</span><span class="p">,</span> <span class="kt">double</span> <span class="n">rotationAngle</span><span class="p">)</span>
</span><span class='line'> <span class="p">{</span>
</span><span class='line'>     <span class="kt">double</span> <span class="n">r</span><span class="p">;</span>
</span><span class='line'>     <span class="kt">double</span> <span class="n">theta</span><span class="p">;</span>
</span><span class='line'>     <span class="kt">double</span> <span class="n">offsetX</span><span class="p">;</span>
</span><span class='line'>     <span class="kt">double</span> <span class="n">offsetY</span><span class="p">;</span>
</span><span class='line'>     <span class="kt">double</span> <span class="n">offsetTheta</span><span class="p">;</span>
</span><span class='line'>     <span class="kt">double</span> <span class="n">rotateX</span><span class="p">;</span>
</span><span class='line'>     <span class="kt">double</span> <span class="n">rotateY</span><span class="p">;</span>
</span><span class='line'>     <span class="kt">double</span> <span class="n">rotationRadians</span><span class="p">;</span>
</span><span class='line'>     <span class="n">IPoint</span> <span class="n">retPoint</span><span class="p">;</span>
</span><span class='line'>     <span class="k">try</span>
</span><span class='line'>     <span class="p">{</span>
</span><span class='line'>         <span class="c1">//shift x and y relative to 0,0 origin </span>
</span><span class='line'>         <span class="n">offsetX</span> <span class="p">=</span> <span class="p">(</span><span class="n">sourcePoint</span><span class="p">.</span><span class="n">X</span> <span class="p">+</span> <span class="p">(</span><span class="n">basePoint</span><span class="p">.</span><span class="n">X</span> <span class="p">*</span> <span class="p">-</span><span class="m">1</span><span class="p">));</span>
</span><span class='line'>         <span class="n">offsetY</span> <span class="p">=</span> <span class="p">(</span><span class="n">sourcePoint</span><span class="p">.</span><span class="n">Y</span> <span class="p">+</span> <span class="p">(</span><span class="n">basePoint</span><span class="p">.</span><span class="n">Y</span> <span class="p">*</span> <span class="p">-</span><span class="m">1</span><span class="p">));</span>
</span><span class='line'>         <span class="c1">//convert to radians. take absolute value (necessary for x coord only). </span>
</span><span class='line'>         <span class="n">offsetX</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Abs</span><span class="p">(</span><span class="n">offsetX</span> <span class="p">*</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">PI</span> <span class="p">/</span> <span class="m">180</span><span class="p">));</span>
</span><span class='line'>         <span class="n">offsetY</span> <span class="p">=</span> <span class="n">offsetY</span> <span class="p">*</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">PI</span> <span class="p">/</span> <span class="m">180</span><span class="p">);</span>
</span><span class='line'>         <span class="n">rotationRadians</span> <span class="p">=</span> <span class="n">rotationAngle</span> <span class="p">*</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">PI</span> <span class="p">/</span> <span class="m">180</span><span class="p">);</span>
</span><span class='line'>         <span class="c1">//get distance from origin to source point </span>
</span><span class='line'>         <span class="n">r</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Sqrt</span><span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">Pow</span><span class="p">(</span><span class="n">offsetX</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span> <span class="p">+</span> <span class="n">Math</span><span class="p">.</span><span class="n">Pow</span><span class="p">(</span><span class="n">offsetY</span><span class="p">,</span> <span class="m">2</span><span class="p">));</span>
</span><span class='line'>         <span class="c1">//get current angle of orientation </span>
</span><span class='line'>         <span class="n">theta</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Atan</span><span class="p">(</span><span class="n">offsetY</span> <span class="p">/</span> <span class="n">offsetX</span><span class="p">);</span>
</span><span class='line'>         <span class="c1">// add rotation value to theta to get new angle of orientation </span>
</span><span class='line'>         <span class="n">offsetTheta</span> <span class="p">=</span> <span class="n">theta</span> <span class="p">+</span> <span class="n">rotationRadians</span><span class="p">;</span>
</span><span class='line'>         <span class="c1">//calculate new x coord </span>
</span><span class='line'>         <span class="n">rotateX</span> <span class="p">=</span> <span class="n">r</span> <span class="p">*</span> <span class="n">Math</span><span class="p">.</span><span class="n">Cos</span><span class="p">(</span><span class="n">offsetTheta</span><span class="p">);</span>
</span><span class='line'>         <span class="c1">//calculate new y coord </span>
</span><span class='line'>         <span class="n">rotateY</span> <span class="p">=</span> <span class="n">r</span> <span class="p">*</span> <span class="n">Math</span><span class="p">.</span><span class="n">Sin</span><span class="p">(</span><span class="n">offsetTheta</span><span class="p">);</span>
</span><span class='line'>         <span class="c1">//convert new x and y back to decimal degrees </span>
</span><span class='line'>         <span class="n">rotateX</span> <span class="p">=</span> <span class="n">rotateX</span> <span class="p">*</span> <span class="p">(</span><span class="m">180</span> <span class="p">/</span> <span class="n">Math</span><span class="p">.</span><span class="n">PI</span><span class="p">);</span>
</span><span class='line'>         <span class="n">rotateY</span> <span class="p">=</span> <span class="n">rotateY</span> <span class="p">*</span> <span class="p">(</span><span class="m">180</span> <span class="p">/</span> <span class="n">Math</span><span class="p">.</span><span class="n">PI</span><span class="p">);</span>
</span><span class='line'>         <span class="c1">//shift new x and y relative to base point </span>
</span><span class='line'>         <span class="n">rotateX</span> <span class="p">=</span> <span class="p">(</span><span class="n">rotateX</span> <span class="p">+</span> <span class="n">basePoint</span><span class="p">.</span><span class="n">X</span><span class="p">);</span>
</span><span class='line'>         <span class="n">rotateY</span> <span class="p">=</span> <span class="p">(</span><span class="n">rotateY</span> <span class="p">+</span> <span class="n">basePoint</span><span class="p">.</span><span class="n">Y</span><span class="p">);</span>
</span><span class='line'>         <span class="c1">//return new point </span>
</span><span class='line'>         <span class="n">retPoint</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PointClass</span><span class="p">();</span>
</span><span class='line'>         <span class="n">retPoint</span><span class="p">.</span><span class="n">X</span> <span class="p">=</span> <span class="n">rotateX</span><span class="p">;</span>
</span><span class='line'>         <span class="n">retPoint</span><span class="p">.</span><span class="n">Y</span> <span class="p">=</span> <span class="n">rotateY</span><span class="p">;</span>
</span><span class='line'>         <span class="k">return</span> <span class="n">retPoint</span><span class="p">;</span>
</span><span class='line'>     <span class="p">}</span>
</span><span class='line'>     <span class="k">catch</span>
</span><span class='line'>     <span class="p">{</span>
</span><span class='line'>         <span class="k">return</span> <span class="n">sourcePoint</span><span class="p">;</span>
</span><span class='line'>     <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/06/19/my-little-open-source-stack/">My Little Open-Source Stack</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-06-19T00:00:00-04:00" pubdate data-updated="true">Jun 19<span>th</span>, 2007</time>
        
         | <a href="/2007/06/19/my-little-open-source-stack/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It&#8217;s been a while since I&#8217;ve posted and things have been busy. Soccer season has ended, the kids have finished school and I&#8217;ve finished up at my client site and moved back to the office. Among the many things I&#8217;ve been working on, I&#8217;ve started building an open-source GIS stack. It&#8217;s not entirely open-source since it&#8217;s installed on a Windows server but the purists will have to get over that.</p>

<p>So far, I&#8217;ve got <a href="http://www.postgresql.org/">PostgreSQL</a>/<a href="http://postgis.refractions.net/">PostGIS</a> and <a href="http://docs.codehaus.org/display/GEOS/Home">GeoServer 1.5.1</a> installed. I&#8217;ve got GeoServer running as a Windows service and I&#8217;ve loaded a couple of data sets into PostGIS, serving one out through GeoServer for now. I&#8217;ve been able to successfully connect to the <a href="http://www.opengeospatial.org/standards/wms">WMS</a> and <a href="http://www.opengeospatial.org/standards/wfs">WFS</a> remotely using <a href="http://udig.refractions.net/confluence/display/UDIG/Home">uDig</a> as a client. <a href="http://code.google.com/apis/kml/documentation/">KML</a> seems to work fine for the sample data sets that install with GeoServer but my test layer doesn&#8217;t work correctly. That&#8217;s not as much of an issue for us right now because we&#8217;ll probably focus on <a href="http://worldwind.arc.nasa.gov/">World Wind</a> for the spinny globe component. Basically, I&#8217;m at the infrastructure-building stage. My next step is to set up <a href="http://www.codeplex.com/SharpMap">SharpMap</a> and start writing some apps.</p>

<p>The only hiccup I&#8217;ve had so far dealt with getting GeoServer to run as a service. Every time I logged out, the service would stop (not a great feature in a service). It turns out that I had the DLL and JARs for the <a href="http://wrapper.tanukisoftware.org/doc/english/introduction.html">Java Service Wrapper</a> in the wrong place. Now it works fine.</p>

<p>So far, I&#8217;m impressed with how smoothly it&#8217;s going. We&#8217;ll see how long that keeps up once I start slinging code. ;)</p>

<p><img alt="The road less traveled?" src="http://geobabble.files.wordpress.com/2007/06/road.jpg" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/05/09/creating-arcobjects-spatial-reference-objects-from-postgis-spatial-reference-definitions/">Creating ArcObjects Spatial Reference Objects From PostGIS Spatial Reference Definitions</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-05-09T00:00:00-04:00" pubdate data-updated="true">May 9<span>th</span>, 2007</time>
        
         | <a href="/2007/05/09/creating-arcobjects-spatial-reference-objects-from-postgis-spatial-reference-definitions/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As discussed in my previous post, I&#8217;m trying to beef up the spatial reference support in zigGIS. I am doing this mainly to introduce support for user-defined spatial references. It pretty much boils down to querying the the appropriate SR from the PostGIS spatial_ref_sys table and applying the value of the srtext column to create a spatial reference in ArcObjects.</p>

<p>This approach has a few advantages and disadvantages. First, the advantages. Although both PostGIS and ESRI implement the EPSG spatial reference codes, there is not a one-to-one match between the two. Therefore, you could get an SRID in PostGIS that&#8217;s not supported in ArcGIS. The approach described above should alleviate that, adding stability. Secondly, if you&#8217;ve created a user-defined spatial reference in PostGIS, you should be able to use it in ArcGIS.</p>

<p>The disadvantages are relatively minor. First, all of the spatial references, even those created from standard EPSG SRs will appear to ArcGIS as custom spatial references, mainly because of the differing syntax of the SR string. Also, some unit definitions from PostGIS are not specifically recognized by ArcGIS. For instance &#8220;US survey feet&#8221; is shown as &#8220;unknown&#8221; in ArcGIS. This last one may be more than minor, depending on if it has any effect on distance calculations and the like but I haven&#8217;t gotten around to testing it yet.</p>

<p>So, how about some code? Here&#8217;s a C# routine that I&#8217;m developing for zigGIS (don&#8217;t look, it&#8217;s not there yet). It&#8217;s based on a previous routine that Paolo and I developed. I should note that the Connection and AutoDataReader objects are zigGIS classes that inherit from ADO.NET classes. You should be able to replace them with standard OleDbConnection and DataReader objects and be fine.</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'>        <span class="k">static</span> <span class="k">public</span> <span class="n">ISpatialReference</span> <span class="nf">setEsriSpatiaReferenceFromSrText</span><span class="p">(</span><span class="kt">int</span> <span class="n">srid</span><span class="p">,</span> <span class="n">Connection</span> <span class="n">conn</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="n">ISpatialReference</span> <span class="n">sr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">UnknownCoordinateSystemClass</span><span class="p">();</span>
</span><span class='line'>            <span class="kt">string</span> <span class="n">srText</span> <span class="p">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>            <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
</span><span class='line'>            <span class="k">try</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="c1">//Bill: query srtext associated with srid</span>
</span><span class='line'>                <span class="n">AutoDataReader</span> <span class="n">dr</span> <span class="p">=</span> <span class="n">conn</span><span class="p">.</span><span class="n">doQuery</span><span class="p">(</span><span class="s">&quot;select * from spatial_ref_sys where srid = &quot;</span> <span class="p">+</span> <span class="n">srid</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span>
</span><span class='line'>                <span class="k">if</span> <span class="p">(</span><span class="n">dr</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">srText</span> <span class="p">=</span> <span class="n">dr</span><span class="p">[</span><span class="s">&quot;srtext&quot;</span><span class="p">]</span> <span class="p">+</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>                    <span class="n">ISpatialReferenceFactory2</span> <span class="n">srf</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SpatialReferenceEnvironmentClass</span><span class="p">();</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span><span class="n">srText</span> <span class="p">==</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="n">sr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">UnknownCoordinateSystemClass</span><span class="p">();</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                    <span class="k">else</span>
</span><span class='line'>                    <span class="p">{</span>
</span><span class='line'>                        <span class="c1">//use srText to construct SR.</span>
</span><span class='line'>                        <span class="n">srf</span><span class="p">.</span><span class="n">CreateESRISpatialReference</span><span class="p">(</span><span class="n">srText</span><span class="p">,</span> <span class="k">out</span> <span class="n">sr</span><span class="p">,</span> <span class="k">out</span> <span class="n">i</span><span class="p">);</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>                <span class="k">return</span> <span class="n">sr</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>            <span class="k">catch</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="c1">//PostGis srid is not implemented as an Esri Factory Code</span>
</span><span class='line'>                <span class="n">sr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">UnknownCoordinateSystemClass</span><span class="p">();</span>
</span><span class='line'>                <span class="k">return</span> <span class="n">sr</span><span class="p">;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/05/08/ziggis-and-spatial-references-part-3/">zigGIS and Spatial References, Part 3</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-05-08T00:00:00-04:00" pubdate data-updated="true">May 8<span>th</span>, 2007</time>
        
         | <a href="/2007/05/08/ziggis-and-spatial-references-part-3/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This post updates <a href="http://geobabble.wordpress.com/2006/12/29/ziggis-and-spatial-references-part-2/">this post</a> and <a href="http://geobabble.wordpress.com/2006/12/21/ziggis-and-spatial-references/">this one</a>.</p>

<p>One of our beloved 5 users ;-), James, pointed out recently that <a href="http://code.google.com/p/ziggis">zigGIS</a> still has issues with user-defined coordinate systems. Alas, this is true. When we implemented support for on-the-fly &#8220;reprojection,&#8221; we limited it to the standard <a href="http://www.epsg.org">EPSG</a> SRIDs supported by both <a href="http://postgis.refractions.net/">PostGIS</a> and <a href="http://www.esri.com/software/arcgis/">ArcGIS</a>. This was mainly due to the fact that we were trying to fix a number of things at once.</p>

<p>I have begun to look at building in support for user-defined spatial references. The main difference I see is that the prj syntax is slightly different between PostGIS and ArcGIS. For example the prj strings for SRID 4326 (WGS84) are not the same. They seem to behave correctly but this creates a situation where ArcGIS will recognize all standard SRs as custom is I load them using the PostGIS strings. It&#8217;s not a huge deal, just interesting. However, <a href="http://www.paolocorti.net">Paolo</a> did notice that ESRI and PostGIS data sources with (theoretically) the same SR can have a slight offset when overlaid in ArcMap. So maybe it&#8217;s more than just interesting.</p>

<p>I plan to leave the current code alone and just put in routines to handle custom SRs but maybe I&#8217;ll also play with the standard ones to see if it makes a difference.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/04/24/moving-forward-on-a-couple-of-fronts/">Moving Forward on a Couple of Fronts</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-04-24T00:00:00-04:00" pubdate data-updated="true">Apr 24<span>th</span>, 2007</time>
        
         | <a href="/2007/04/24/moving-forward-on-a-couple-of-fronts/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Well, it&#8217;s been a while since I&#8217;ve posted anything technical. Work has been a little crazy and I&#8217;m not willing to carve into time with the family to keep other stuff moving. As a result a few things have been sitting for a while but I&#8217;ve been able to get around to two things.</p>

<p>First, I&#8217;ve been playing with making a <a href="http://msdn2.microsoft.com/en-us/netframework/aa663324.aspx">WCF</a> web service that wraps spatial calls to <a href="http://postgis.refractions.net/">PostGIS</a>. The first thing I&#8217;m building is a call to do a coordinate transformation. Fairly simple stuff. This is actually my standard &#8220;getting my feet wet&#8221; task. I have written the same thing over the years in MapObjects, ArcObjects, ArcGIS Server, COM, Java, VB.NET, C#&#8230;you name it. Now, it&#8217;s my guinea pig for WCF.</p>

<p>WCF changes the way web services are done in .NET. Given the larger focus on support SOA with .NET 3.0, the changes make sense. Overall, I think SOA in general will be easier in 3.0 but web services in particular are not as simple to implement as in 2.0. That&#8217;s an overall change for the better IMO but it takes some getting used to. I&#8217;ve pretty much got it working on the service side but my client code is still having trouble. Once I get it ironed out, I plan to post what I did and discuss some of the issues.</p>

<p>Secondly, I&#8217;m picking back up with building ArcCatalog objects for <a href="http://code.google.com/p/ziggis">ZigGIS</a>. I&#8217;m trying to follow the model <a href="http://www.esri.com">ESRI</a> established with how to manage connections to ArcSDE in ArcCatalog. I&#8217;ve gotten far enough that I have a connection dialog that will write out a .zig file. The next step is to iterate the .zig files and list them as nodes in the ArcCatalog tree. More on that as I move along, also.</p>

<p>So the purpose of this post is really more to stick my head out and say &#8220;I&#8217;m still here.&#8221; There, I&#8217;ve said it. More again soon&#8230;</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/33/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/31/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-2600437314795269";
/* geoMusings - GIS */
google_ad_slot = "1381808721";
google_ad_width = 250;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</section>
<section>

<a href="http://twitter.com/billdollins"><img src="/images/twitter.png" width="32" height="32" alt="View my Twitter profile"></a>&nbsp;


<a href="http://www.linkedin.com/in/billdollins"><img src="/images/linkedin.png" width="32" height="32" alt="View LinkedIn profile of Bill Dollins"></a>&nbsp;


<a href="https://plus.google.com/103048542132426664956?rel=author"><img src="/images/gplus.png" width="32" height="32"></a>&nbsp;


<a href="http://www.facebook.com/pages/GeoMusings/304146182966988"><img src="/images/fb.png" width="32" height="32" alt="Follow my Facebook page"></a>&nbsp;


<a href="https://github.com/geobabbler"><img src="/images/github32.png" width="32" height="32" alt="View my profile on GitHub"></a>&nbsp;

</section>

<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/02/18/a-little-deeper-with-node-and-postgis/">A Little Deeper with Node and PostGIS</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/17/url-utility-for-twitter-direct-messages/">URL Utility for Twitter Direct Messages</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/13/initial-thoughts-on-the-dc-devsummit/">Initial Thoughts On the DC DevSummit</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("billdollins", 3, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/billdollins" class="twitter-follow-button" data-show-count="false">Follow @billdollins</a>
  
</section>

<section>
  <h1>Disclaimer</h1>
  <p>The information in this weblog is provided &#8220;AS IS&#8221; with no warranties, and confers no rights.
  <br/> <br/>
  This weblog does not represent the thoughts, intentions, plans or strategies of my employer. It is solely my opinion and probably incorrect.
  </p>
</section>
<section>
<img src="/images/geomusings.png" width="64" height="64" alt="View my Twitter profile">
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Bill Dollins -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  - <span class="credit">Theme by <a href="http://www.gehaxelt.in">Gehaxelt</a></span>
  <span class="credit">and <a href="http://www.it-solutions-neef.de">IT Solutions Neef</a></span>
  <!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=2901378; 
var sc_invisible=1; 
var sc_security="be706774"; 
</script>
<script type="text/javascript"
src="http://www.statcounter.com/counter/counter.js"></script>
<noscript><div class="statcounter"><a title="free web stats"
href="http://statcounter.com/free-web-stats/"
target="_blank"><img class="statcounter"
src="http://c.statcounter.com/2901378/0/be706774/1/"
alt="free web stats"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
<!-- Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37240509-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- End of Google Analytics -->
<!-- MapStats -->
<script
type="text/javascript"
src="http://54.214.24.130/api/visits/2"></script>
<!-- End of MapStats -->
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'geomusings';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
