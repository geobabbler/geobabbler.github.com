<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: georss | geoMusings]]></title>
  <link href="http://blog.geomusings.com/blog/categories/georss/atom.xml" rel="self"/>
  <link href="http://blog.geomusings.com/"/>
  <updated>2012-12-18T14:17:38-05:00</updated>
  <id>http://blog.geomusings.com/</id>
  <author>
    <name><![CDATA[Bill Dollins]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Using Dynamic Non-Spatial Data In GeoCommons]]></title>
    <link href="http://blog.geomusings.com/2011/09/07/Using-Dynamic-Non-Spatial-Data-In-GeoCommons/"/>
    <updated>2011-09-07T00:00:00-04:00</updated>
    <id>http://blog.geomusings.com/2011/09/07/Using-Dynamic-Non-Spatial-Data-In-GeoCommons</id>
    <content type="html"><![CDATA[<p>In <a href="http://blog.geomusings.com/2011/08/30/prying-data-open/">my previous post</a>, I described how I used a Python script to scrape power outage information from a local web site and convert it into an RSS feed. In this post, I'll show how I used GeoCommons to visualize the changing information over time.</p>

<p>The process starts by creating a data set in GeoCommmons based on a URL link to the feed created in the previous post. The general process for doing that can be found <a href="http://geocommons.com/help/User_Manual#Add-a-URL-Link-from-the-web">here</a> in the GeoCommons documentation.</p>

<!--more-->


<p>My feed is not a GeoRSS feed so it has no location data of its own for GeoCommons to work with. During the upload process, I reached this screen, which starts the process of helping to attach location to my data.</p>

<p><img alt="" class="aligncenter size-full wp-image-2037" height="388" src="http://geobabble.files.wordpress.com/2011/09/geocommons4.png" title="Geolocating data in GeoCommons" width="590" /></p>

<p>The feed summarizes power outage by ZIP code so I chose "Join with a boundary dataset" so that I could join it with ZIP code boundaries I had previously uploaded.</p>

<p>I selected the attribute in my feed (title) that was to be used to join with a corresponding attribute in the boundary data set (Zip) as shown below.</p>

<p><img alt="" class="aligncenter size-full wp-image-2038" height="345" src="http://geobabble.files.wordpress.com/2011/09/geocommons6.png" title="GeoCommons6" width="590" /></p>

<p>You'll notice that the success message indicates three features were matched. This is true for this version of the feed because ZIP codes with zero power outages are not reported. The join, however, updates itself as the feed updates so more or less polygons may appear in the current version, depending upon feed content.</p>

<p>After reviewing my data and providing some basic metadata, GeoCommons performed the join and my data set was ready to go.</p>

<p><img alt="" class="aligncenter size-full wp-image-2041" height="443" src="http://geobabble.files.wordpress.com/2011/09/geocommons9.png" title="Completed data set" width="554" /></p>

<p>In the image above, you'll notice a link labeled "fetch latest." That link, which is formatted as "http://geocommons.com/overlays/{overlayid}/fetch," can be used to manually get the latest version of the feed, which is stored by GeoCommons. Essentially, GeoCommons stores the state of each feature in the data set as the feed is fetched so you build a "version history" your data. As long as you have a date/time attribute, you can use GeoCommons to visualize the changes over time.</p>

<p>In addition to the Python code from previous post, I also used a variant on the script found at <a href="http://www.voidspace.org.uk/python/articles/authentication.shtml">http://www.voidspace.org.uk/python/articles/authentication.shtml</a>. The fetching capability requires authentication so I modified the script to call the "fetch" URL using my GeoCommons user name and password. The script may be overkill but work perfectly without any changes.</p>

<p>On the server, I wrote a four-line batch file to act as a driver for the whole process. This batch file is what is called by a scheduled task in Windows.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='powershell'><span class='line'><span class="n">del</span> <span class="p">&lt;</span><span class="n">em</span><span class="p">&gt;.</span><span class="n">xml</span>
</span><span class='line'><span class="n">del</span> <span class="p">&lt;/</span><span class="n">em</span><span class="p">&gt;.</span><span class="n">pickle</span>
</span><span class='line'><span class="n">python</span> <span class="n">SmecoFeedObj</span><span class="p">.</span><span class="n">py</span>
</span><span class='line'><span class="n">python</span> <span class="n">fetchlatest</span><span class="p">.</span><span class="n">py</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>As you can see, the batch is very simple. It deletes the old files, scrapes the latest version and writes new files (SmecoFeedObj.py) and then updates the GeoCommons data set (fetchlatest.py).</p>

<p>The server is a Windows server so I set up a scheduled task (How to: <a href="http://support.microsoft.com/kb/308569">XP</a>, <a href="http://windows.microsoft.com/en-US/windows-vista/Schedule-a-task">Vista</a>, <a href="http://windows.microsoft.com/en-US/windows7/schedule-a-task">Windows 7</a>, <a href="http://technet.microsoft.com/en-us/library/cc738106(WS.10).aspx">Server 2003</a>, <a href="http://technet.microsoft.com/en-us/library/cc725745.aspx">Server 2008</a>). I set my task up to run once an hour so the latest data is scraped and pushed to GeoCommons hourly.</p>

<p>With the data set now created and being updated, it can be used to make maps in GeoCommons to visualize the changing data. I created two maps to demonstrate this. <a href="http://geocommons.com/maps/97820">The first</a>, using a filter, allows a user to filter the feed data to a time window of their choosing and map just the outage data for that time window.</p>

<p>The <a href="http://geocommons.com/maps/97820">second map</a>, shown below, uses GeoCommons animation capability to allow a user to "play through" the data based upon the publication date/time. A user can either drag the time slider manually or let it play automatically. They can also adjust the width of the slider to narrow/widen the time window. I've been told by GeoIQ that animation is under active improvement so I'm interested to see how it evolves. This was my first attempt at using it with my own data so I'm sure I'm not using it optimally. That said, I'm impressed with how easy it was to set up a time-based animation.</p>

<div style="text-align: center"><a href="http://geocommons.com/maps/97820"><img alt="" class="size-full wp-image-2043" height="278" src="http://geobabble.files.wordpress.com/2011/09/geocommons10.png" title="GeoCommons map animating power outage data" width="590" /></a><div style="text-align: center;font-size: 14px;">GeoCommons map animating power outage data<br/></div></div>


<p>All-in-all, it took me about 4 hours to go from data embedded in an HTML page to a working map animation. That really speaks to the power of the tools available today, from programming languages like Python and open standards like RSS to online tools like GeoCommons, as well as a host of others I didn't use for this work. It is becoming easier all the time to integrate and use spatial tools to exploit data from traditionally non-spatial sources and share the results widely. As traditional "GIS" fades into the background, the resulting fusion of more standard technologies is opening a wider world of possibilities.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[GeoLocation API for Twitter Announced]]></title>
    <link href="http://blog.geomusings.com/2009/08/20/GeoLocation-API-for-Twitter-Announced/"/>
    <updated>2009-08-20T00:00:00-04:00</updated>
    <id>http://blog.geomusings.com/2009/08/20/GeoLocation-API-for-Twitter-Announced</id>
    <content type="html"><![CDATA[<p>Ryan Sarver <a href="http://blog.twitter.com/2009/08/location-location-location.html">announced today</a> the availability of a geolocation API for Twitter. It even supports GeoRSS and GeoJSON. This could be a potentially significant new step for Twitter. It looks like the API will be opened to <del datetime="2009-08-20T23:50:17+00:00">platform developers first</del> everyone (see <a href="http://twitter.com/rsarver/statuses/3437734477">here</a>).</p>

<p>Tying in location to the near-real-time nature of the Twitter timeline opens up lots of potential location-based applications. Let the slippy-mapping commence!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Consuming GeoRSS in ArcMap With InMemoryWorkspaceFactory]]></title>
    <link href="http://blog.geomusings.com/2007/07/10/Consuming-GeoRSS-in-ArcMap-With-InMemoryWorkspaceFactory/"/>
    <updated>2007-07-10T00:00:00-04:00</updated>
    <id>http://blog.geomusings.com/2007/07/10/Consuming-GeoRSS-in-ArcMap-With-InMemoryWorkspaceFactory</id>
    <content type="html"><![CDATA[<p>This will be my last post for a couple of weeks. I'm heading out to Florida tomorrow to spend time with my family and the Mouse. But before I head out, I thought I'd share a little something I've been working on.</p>

<p>I've been playing the last few days with the <a href="http://edndoc.esri.com/arcobjects/9.2/ComponentHelp/esriDataSourcesGDB/InMemoryWorkspaceFactory.htm">InMemoryWorkspaceFactory</a> class in ArcObjects. I am looking at using it for a project I will be working on when I get back so I thought I'd do a little prototyping beforehand.</p>

<p>The fact that it works in memory is very attractive, especially for using volatile data. <a href="http://georss.org/">GeoRSS</a> seemed like a natural source to use for prototyping.</p>

<!--more-->


<p>I wrote this in C# as a set of tools for ArcMap 9.2. The first thing I did was create a static reference to a single InMemoryWorkspaceFactory. It's a singleton anyway but this approach forces me to use a single entry point.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">initInMemoryWorkspaceFactory</span><span class="p">()</span>
</span><span class='line'><span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="c1">// Create an InMemory workspace factory.</span>
</span><span class='line'><span class="n">InMemoryWorkspaceFactory</span> <span class="n">workspaceFactory</span> <span class="p">=</span> <span class="k">new</span> <span class="n">InMemoryWorkspaceFactoryClass</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Create an InMemory geodatabase.</span>
</span><span class='line'><span class="n">IWorkspaceName</span> <span class="n">workspaceName</span> <span class="p">=</span> <span class="n">workspaceFactory</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;GeoRssWorkspace&quot;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Cast for IName.</span>
</span><span class='line'><span class="n">IName</span> <span class="n">name</span> <span class="p">=</span> <span class="p">(</span><span class="n">IName</span><span class="p">)</span><span class="n">workspaceName</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//Open a reference to the in-memory workspace through the name object.</span>
</span><span class='line'><span class="n">IWorkspace</span> <span class="n">inmemWor</span> <span class="p">=</span> <span class="p">(</span><span class="n">IWorkspace</span><span class="p">)</span><span class="n">name</span><span class="p">.</span><span class="n">Open</span><span class="p">();</span>
</span><span class='line'><span class="n">m_memFeatWorkspace</span> <span class="p">=</span> <span class="p">(</span><span class="n">IFeatureWorkspace</span><span class="p">)</span><span class="n">inmemWor</span><span class="p">;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Next, I created a custom FeatureLayer class called GeoRssFeatureLayer. It inherits from the ArcObjects FeatureLayer class and implements a custom interface called IGeoRssFeatureLayer. Using inheritance makes it easy to pass an instance around within ArcObjects and have it behave properly. Here's a snippet with the interface and class declaration:
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">interface</span> <span class="n">IGeoRssFeatureLayer</span>
</span><span class='line'><span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="kt">string</span> <span class="n">Uri</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;}</span>
</span><span class='line'><span class="k">void</span> <span class="nf">Refresh</span><span class="p">();</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;[</span><span class="n">Guid</span><span class="p">(</span><span class="s">&quot;a675765b-30d0-4294-ad98-28579c9f8994&quot;</span><span class="p">)]</span>
</span><span class='line'><span class="na">[ClassInterface(ClassInterfaceType.None)]</span>
</span><span class='line'><span class="na">[ProgId(&quot;ztGeoRss.GeoRssFeatureLayer&quot;)]</span>
</span><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">GeoRssFeatureLayer</span> <span class="p">:</span> <span class="n">ESRI</span><span class="p">.</span><span class="n">ArcGIS</span><span class="p">.</span><span class="n">Carto</span><span class="p">.</span><span class="n">FeatureLayerClass</span><span class="p">,</span> <span class="n">IGeoRssFeatureLayer</span><span class="p">&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="k">private</span> <span class="kt">string</span> <span class="n">m_uri</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</span><span class='line'><span class="k">private</span> <span class="n">IFeatureClass</span> <span class="n">m_fc</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class='line'><span class="k">public</span> <span class="nf">GeoRssFeatureLayer</span><span class="p">(</span><span class="kt">string</span> <span class="n">uri</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">m_uri</span> <span class="p">=</span> <span class="n">uri</span><span class="p">;</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="n">Refresh</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
I also added a constructor so I could pass in the URI directly. The IGeoRssFeatureLayer.Refresh method does most of the heavy lifting with some help from the loadFeatures method and a few statics in the Ambient class (it's a pretty name that gets the point across without conflicting with reserved words like "Environment"):
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">Refresh</span><span class="p">()</span>
</span><span class='line'><span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="k">if</span> <span class="p">(</span><span class="n">m_fc</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">Marshal</span><span class="p">.</span><span class="n">ReleaseComObject</span><span class="p">(</span><span class="n">m_fc</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="n">m_fc</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class='line'><span class="n">ISpatialReferenceFactory</span> <span class="n">srf</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SpatialReferenceEnvironmentClass</span><span class="p">();</span>
</span><span class='line'><span class="n">ISpatialReference</span> <span class="n">sr</span> <span class="p">=</span> <span class="n">srf</span><span class="p">.</span><span class="n">CreateGeographicCoordinateSystem</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">esriSRGeoCSType</span><span class="p">.</span><span class="n">esriSRGeoCS_WGS1984</span><span class="p">);</span>
</span><span class='line'><span class="n">sr</span><span class="p">.</span><span class="n">SetDomain</span><span class="p">(-</span><span class="m">180</span><span class="p">,</span> <span class="m">180</span><span class="p">,</span> <span class="p">-</span><span class="m">90</span><span class="p">,</span> <span class="m">90</span><span class="p">);</span>
</span><span class='line'><span class="n">IGeometryDefEdit</span> <span class="n">gde</span> <span class="p">=</span> <span class="p">(</span><span class="n">IGeometryDefEdit</span><span class="p">)</span><span class="k">new</span> <span class="n">GeometryDefClass</span><span class="p">();</span>
</span><span class='line'><span class="n">gde</span><span class="p">.</span><span class="n">SpatialReference_2</span> <span class="p">=</span> <span class="n">sr</span><span class="p">;</span>
</span><span class='line'><span class="n">gde</span><span class="p">.</span><span class="n">GeometryType_2</span> <span class="p">=</span> <span class="n">esriGeometryType</span><span class="p">.</span><span class="n">esriGeometryPoint</span><span class="p">;</span>
</span><span class='line'><span class="n">gde</span><span class="p">.</span><span class="n">GridCount_2</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
</span><span class='line'><span class="n">gde</span><span class="p">.</span><span class="n">set_GridSize</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1000</span><span class="p">);</span>
</span><span class='line'><span class="n">IFieldsEdit</span> <span class="n">fe</span> <span class="p">=</span> <span class="p">(</span><span class="n">IFieldsEdit</span><span class="p">)</span><span class="k">new</span> <span class="n">FieldsClass</span><span class="p">();</span>
</span><span class='line'><span class="n">fe</span><span class="p">.</span><span class="n">AddField</span><span class="p">(</span><span class="n">Ambient</span><span class="p">.</span><span class="n">makeField</span><span class="p">(</span><span class="s">&quot;OBJECTID&quot;</span><span class="p">,</span> <span class="n">esriFieldType</span><span class="p">.</span><span class="n">esriFieldTypeOID</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="k">null</span><span class="p">));</span>
</span><span class='line'><span class="n">fe</span><span class="p">.</span><span class="n">AddField</span><span class="p">(</span><span class="n">Ambient</span><span class="p">.</span><span class="n">makeField</span><span class="p">(</span><span class="s">&quot;SHAPE&quot;</span><span class="p">,</span> <span class="n">esriFieldType</span><span class="p">.</span><span class="n">esriFieldTypeGeometry</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="p">(</span><span class="n">IGeometryDef</span><span class="p">)</span><span class="n">gde</span><span class="p">));</span>
</span><span class='line'><span class="n">fe</span><span class="p">.</span><span class="n">AddField</span><span class="p">(</span><span class="n">Ambient</span><span class="p">.</span><span class="n">makeField</span><span class="p">(</span><span class="s">&quot;Title&quot;</span><span class="p">,</span> <span class="n">esriFieldType</span><span class="p">.</span><span class="n">esriFieldTypeString</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="k">null</span><span class="p">));</span>
</span><span class='line'><span class="n">fe</span><span class="p">.</span><span class="n">AddField</span><span class="p">(</span><span class="n">Ambient</span><span class="p">.</span><span class="n">makeField</span><span class="p">(</span><span class="s">&quot;Description&quot;</span><span class="p">,</span> <span class="n">esriFieldType</span><span class="p">.</span><span class="n">esriFieldTypeString</span><span class="p">,</span> <span class="m">300</span><span class="p">,</span> <span class="k">null</span><span class="p">));</span>
</span><span class='line'><span class="n">fe</span><span class="p">.</span><span class="n">AddField</span><span class="p">(</span><span class="n">Ambient</span><span class="p">.</span><span class="n">makeField</span><span class="p">(</span><span class="s">&quot;Link&quot;</span><span class="p">,</span> <span class="n">esriFieldType</span><span class="p">.</span><span class="n">esriFieldTypeString</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="k">null</span><span class="p">));</span>
</span><span class='line'><span class="n">fe</span><span class="p">.</span><span class="n">AddField</span><span class="p">(</span><span class="n">Ambient</span><span class="p">.</span><span class="n">makeField</span><span class="p">(</span><span class="s">&quot;Author&quot;</span><span class="p">,</span> <span class="n">esriFieldType</span><span class="p">.</span><span class="n">esriFieldTypeString</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="k">null</span><span class="p">));</span>
</span><span class='line'><span class="n">fe</span><span class="p">.</span><span class="n">AddField</span><span class="p">(</span><span class="n">Ambient</span><span class="p">.</span><span class="n">makeField</span><span class="p">(</span><span class="s">&quot;Comments&quot;</span><span class="p">,</span> <span class="n">esriFieldType</span><span class="p">.</span><span class="n">esriFieldTypeString</span><span class="p">,</span> <span class="m">300</span><span class="p">,</span> <span class="k">null</span><span class="p">));</span>
</span><span class='line'><span class="n">fe</span><span class="p">.</span><span class="n">AddField</span><span class="p">(</span><span class="n">Ambient</span><span class="p">.</span><span class="n">makeField</span><span class="p">(</span><span class="s">&quot;PubDate&quot;</span><span class="p">,</span> <span class="n">esriFieldType</span><span class="p">.</span><span class="n">esriFieldTypeString</span><span class="p">,</span> <span class="m">50</span><span class="p">,</span> <span class="k">null</span><span class="p">));</span>
</span><span class='line'><span class="n">fe</span><span class="p">.</span><span class="n">AddField</span><span class="p">(</span><span class="n">Ambient</span><span class="p">.</span><span class="n">makeField</span><span class="p">(</span><span class="s">&quot;Guid&quot;</span><span class="p">,</span> <span class="n">esriFieldType</span><span class="p">.</span><span class="n">esriFieldTypeString</span><span class="p">,</span> <span class="m">50</span><span class="p">,</span> <span class="k">null</span><span class="p">));</span>
</span><span class='line'><span class="n">IFeatureWorkspace</span> <span class="n">fws</span> <span class="p">=</span> <span class="n">Ambient</span><span class="p">.</span><span class="n">GeoRssWorkspace</span><span class="p">;</span>
</span><span class='line'><span class="n">m_fc</span> <span class="p">=</span> <span class="n">fws</span><span class="p">.</span><span class="n">CreateFeatureClass</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Guid</span><span class="p">.</span><span class="n">NewGuid</span><span class="p">().</span><span class="n">ToString</span><span class="p">(),</span> <span class="p">(</span><span class="n">IFields</span><span class="p">)</span><span class="n">fe</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">esriFeatureType</span><span class="p">.</span><span class="n">esriFTSimple</span><span class="p">,</span> <span class="s">&quot;Shape&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">);</span>
</span><span class='line'><span class="n">loadFeatures</span><span class="p">();</span>
</span><span class='line'><span class="k">base</span><span class="p">.</span><span class="n">FeatureClass</span> <span class="p">=</span> <span class="n">m_fc</span><span class="p">;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">private</span> <span class="k">void</span> <span class="n">loadFeatures</span><span class="p">()</span>
</span><span class='line'><span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="n">RssFeed</span> <span class="n">f</span> <span class="p">=</span> <span class="n">RssReader</span><span class="p">.</span><span class="n">GetFeed</span><span class="p">(</span><span class="n">m_uri</span><span class="p">);</span>
</span><span class='line'><span class="k">base</span><span class="p">.</span><span class="n">Name</span> <span class="p">=</span> <span class="n">f</span><span class="p">.</span><span class="n">Title</span><span class="p">;</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Count</span> <span class="p">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">gt</span><span class="p">;</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">//Cast for an IWorkspaceEdit        </span>
</span><span class='line'>    <span class="n">IWorkspaceEdit</span> <span class="n">workspaceEdit</span> <span class="p">=</span> <span class="p">(</span><span class="n">IWorkspaceEdit</span><span class="p">)</span><span class="n">Ambient</span><span class="p">.</span><span class="n">GeoRssWorkspace</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">//Start an edit session and operation        </span>
</span><span class='line'>    <span class="n">workspaceEdit</span><span class="p">.</span><span class="n">StartEditing</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</span><span class='line'>    <span class="n">workspaceEdit</span><span class="p">.</span><span class="n">StartEditOperation</span><span class="p">();</span>
</span><span class='line'>    <span class="c1">//Create the Feature Buffer        </span>
</span><span class='line'>    <span class="n">IFeatureBuffer</span> <span class="n">featureBuffer</span> <span class="p">=</span> <span class="n">m_fc</span><span class="p">.</span><span class="n">CreateFeatureBuffer</span><span class="p">();</span>
</span><span class='line'>    <span class="c1">//Create insert Feature Cursor using buffering = true.        </span>
</span><span class='line'>    <span class="n">IFeatureCursor</span> <span class="n">featureCursor</span> <span class="p">=</span> <span class="n">m_fc</span><span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</span><span class='line'>    <span class="n">IPoint</span> <span class="n">pt</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PointClass</span><span class="p">();</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="p">(</span><span class="n">i</span> <span class="p">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">lt</span><span class="p">;=</span> <span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Count</span> <span class="p">-</span> <span class="m">1</span><span class="p">));</span> <span class="n">i</span><span class="p">++)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">RssItem</span> <span class="n">itm</span> <span class="p">=</span> <span class="n">f</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span class='line'>        <span class="n">pt</span><span class="p">.</span><span class="n">X</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToDouble</span><span class="p">(</span><span class="n">itm</span><span class="p">.</span><span class="n">Longitude</span><span class="p">);</span>
</span><span class='line'>        <span class="n">pt</span><span class="p">.</span><span class="n">Y</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToDouble</span><span class="p">(</span><span class="n">itm</span><span class="p">.</span><span class="n">Latitude</span><span class="p">);</span>
</span><span class='line'>        <span class="n">featureBuffer</span><span class="p">.</span><span class="n">Shape</span> <span class="p">=</span> <span class="n">pt</span><span class="p">;</span>
</span><span class='line'>        <span class="n">featureBuffer</span><span class="p">.</span><span class="n">set_Value</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="n">itm</span><span class="p">.</span><span class="n">Title</span><span class="p">);</span>
</span><span class='line'>        <span class="n">featureBuffer</span><span class="p">.</span><span class="n">set_Value</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="n">itm</span><span class="p">.</span><span class="n">Description</span><span class="p">);</span>
</span><span class='line'>        <span class="n">featureBuffer</span><span class="p">.</span><span class="n">set_Value</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="n">itm</span><span class="p">.</span><span class="n">Link</span><span class="p">);</span>
</span><span class='line'>        <span class="n">featureBuffer</span><span class="p">.</span><span class="n">set_Value</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="n">itm</span><span class="p">.</span><span class="n">Author</span><span class="p">);</span>
</span><span class='line'>        <span class="n">featureBuffer</span><span class="p">.</span><span class="n">set_Value</span><span class="p">(</span><span class="m">6</span><span class="p">,</span> <span class="n">itm</span><span class="p">.</span><span class="n">Comments</span><span class="p">);</span>
</span><span class='line'>        <span class="n">featureBuffer</span><span class="p">.</span><span class="n">set_Value</span><span class="p">(</span><span class="m">7</span><span class="p">,</span> <span class="n">itm</span><span class="p">.</span><span class="n">Pubdate</span><span class="p">);</span>
</span><span class='line'>        <span class="n">featureBuffer</span><span class="p">.</span><span class="n">set_Value</span><span class="p">(</span><span class="m">8</span><span class="p">,</span> <span class="n">itm</span><span class="p">.</span><span class="n">Guid</span><span class="p">);</span>
</span><span class='line'>        <span class="kt">object</span> <span class="n">oid</span> <span class="p">=</span> <span class="n">featureCursor</span><span class="p">.</span><span class="n">InsertFeature</span><span class="p">(</span><span class="n">featureBuffer</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="c1">//Flush the feature cursor to the database        </span>
</span><span class='line'>    <span class="c1">//Calling flush allows you to handle any errors at a known time rather then on the cursor destruction.        </span>
</span><span class='line'>    <span class="n">featureCursor</span><span class="p">.</span><span class="n">Flush</span><span class="p">();</span>
</span><span class='line'>    <span class="c1">//Stop editing        </span>
</span><span class='line'>    <span class="n">workspaceEdit</span><span class="p">.</span><span class="n">StopEditOperation</span><span class="p">();</span>
</span><span class='line'>    <span class="n">workspaceEdit</span><span class="p">.</span><span class="n">StopEditing</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</span><span class='line'>    <span class="c1">//Release the Cursor        </span>
</span><span class='line'>    <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">.</span><span class="n">ReleaseComObject</span><span class="p">(</span><span class="n">featureCursor</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>That pretty much does most of the real work. I have an ArcObjects command that actually instantiates the layer and adds it to ArcMap and there are a few helper functions as well. I snagged a good bit of other people's code to be able to turn around a prototype quickly so credit where credit is due:</p>

<ul>
    <li><a href="http://www.codeproject.com/KB/cs/rssreader.aspx">RssReader</a> on CodeProject - This handles the interaction with the feeds. I extended it to support geo tags</li>
    <li><a href="http://www.codeproject.com/cs/miscctrl/InputBox.asp">InputBox</a> on CodeProject - I used this to provide a simple means to allow the user to enter a URI.</li>
    <li>I also C#-ified some of <a href="http://ambergis.wordpress.com/">Kirk's</a> code I found on the ESRI forums</li>
    <li>I also grabbed a few lines from the ESRI help files</li>
</ul>


<p>I'll probably post an update when I get back but here's a screen capture. It depicts <a href="http://earthquake.usgs.gov/eqcenter/catalogs/eqs7day-M2.5.xml">USGS M2.5+ Earthquakes feed</a> and the path of <a href="http://krkinnan.members.winisp.net/georss/2004hurricaneivan.xml">Hurricane Ivan in 2004</a>. As of this writing, it only handles points in the "simple" formats.</p>

<p><a href="http://geobabble.files.wordpress.com/2007/07/georss_arcmap.png" title="GeoRSS in ArcMap"><img alt="GeoRSS in ArcMap" src="http://geobabble.files.wordpress.com/2007/07/georss_arcmap.thumbnail.png" /></a></p>

<p>Basically, I like the in-memory implementation because it allows for a pretty fast refresh plus it allows selections (note the selection of the last few positions of Ivan), identify (with automatic hyperlinking from the identify window) and other operations, make it a big plus over an XY event layer. It remains to be seen if there are any memory leaks but that'll come with further testing.</p>

<p><strong>UPDATE:</strong> Basically, the biggest problem with this approach right now is that a feature class can't contain multiple geometry types, regardless of the type of workspace. This is a big pain and makes management of a full GeoRSS feed (with points, lines and polygons) difficult. I'll post more when I get farther.</p>

<p><a href="http://www.statcounter.com/" target="_blank"><img alt="hit counter" border="0" src="http://c31.statcounter.com/2901378/0/be706774/0/" /></a></p>
]]></content>
  </entry>
  
</feed>
